{%- style -%}
  .mbp-section {
    background: #F8F5F0;
    padding: 80px 24px 100px;
  }
  .mbp-inner {
    max-width: 1260px;
    margin: 0 auto;
  }
  .mbp-header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 16px;
    margin-bottom: 44px;
  }
  @media (max-width: 640px) {
    .mbp-header { flex-direction: column; align-items: flex-start; }
  }
  .mbp-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2rem, 3.5vw, 3rem);
    font-weight: 400;
    color: #1A2E1A;
    margin: 0;
    letter-spacing: -0.01em;
    line-height: 1.15;
  }
  .mbp-view-all {
    font-family: 'Inter', sans-serif;
    font-size: 1.2rem;
    font-weight: 500;
    color: #1A2E1A;
    text-decoration: none;
    border-bottom: 1px solid rgba(26,46,26,0.3);
    padding-bottom: 2px;
    white-space: nowrap;
    transition: border-color 0.2s;
  }
  .mbp-view-all:hover { border-color: #1A2E1A; }

  /* Grid */
  .mbp-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 24px;
  }
  @media (max-width: 1024px) { .mbp-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (max-width: 480px)  {
    .mbp-grid { grid-template-columns: 1fr; gap: 20px; }
    .mbp-card:not(:first-child) { display: none; }
  }

  /* Card */
  .mbp-card {
    text-decoration: none;
    color: inherit;
    display: block;
  }
  .mbp-card__img-wrap {
    position: relative;
    width: 100%;
    padding-top: 100%; /* 1:1 */
    overflow: hidden;
    border-radius: 10px;
    background: #EEE9E1;
    margin-bottom: 18px;
  }
  .mbp-card__img-wrap img {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    transition: transform 0.35s ease;
    display: block;
  }
  .mbp-card:hover .mbp-card__img-wrap img {
    transform: scale(1.04);
  }
  .mbp-card__no-img {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.12;
  }
  .mbp-card__date {
    font-family: 'Inter', sans-serif;
    font-size: 1.05rem;
    color: #1A2E1A;
    opacity: 0.5;
    margin: 0 0 8px;
    letter-spacing: 0.04em;
  }
  .mbp-card__title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.8rem;
    font-weight: 400;
    color: #1A2E1A;
    line-height: 1.3;
    margin: 0 0 12px;
  }
  .mbp-card__more {
    font-family: 'Inter', sans-serif;
    font-size: 1.1rem;
    font-weight: 500;
    color: #4a7c59;
    letter-spacing: 0.04em;
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s;
    display: inline-block;
  }
  .mbp-card:hover .mbp-card__more {
    border-color: #4a7c59;
  }
{%- endstyle -%}

{%- assign blog_handle = section.settings.blog | default: 'noticias' -%}
{%- assign blog_obj = blogs[blog_handle] -%}

<section class="mbp-section">
  <div class="mbp-inner">
    <div class="mbp-header">
      <h2 class="mbp-title">{{ section.settings.heading }}</h2>
      <a href="/blogs/{{ blog_handle }}" class="mbp-view-all">Ver todas las noticias →</a>
    </div>

    <div class="mbp-grid">
      {%- for article in blog_obj.articles limit: 4 -%}
        <a class="mbp-card" href="{{ article.url }}">
          <div class="mbp-card__img-wrap">
            {%- if article.image -%}
              <img src="{{ article.image | image_url: width: 600 }}"
                   alt="{{ article.image.alt | escape | default: article.title }}"
                   loading="lazy"
                   width="600" height="600">
            {%- else -%}
              <div class="mbp-card__no-img">
                {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
              </div>
            {%- endif -%}
          </div>
          <p class="mbp-card__date">{{ article.published_at | date: '%d %b %Y' }}</p>
          <h3 class="mbp-card__title">{{ article.title }}</h3>
          <span class="mbp-card__more">Leer más →</span>
        </a>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Blog — Últimas noticias",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Título",
      "default": "Últimas noticias"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    }
  ],
  "presets": [
    { "name": "Blog — Últimas noticias" }
  ]
}
{% endschema %}
